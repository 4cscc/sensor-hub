- name: setup sensor-dashboard and establish service
  hosts: all
  tasks:

  - name: create directory
    file:
      path: /home/beta/sensor-dashboard
      state: directory
  
  - name: install sensor-dashboard
    pip:
      name: git+https://github.com/4cscc/sensor-dashboard.git@main
      state: forcereinstall
      virtualenv: /home/beta/sensor-dashboard/venv
      virtualenv_command: python3 -m venv

  - name: copy viz_dashboard systemd service setup file
    ansible.builtin.copy:
      src: ../setup_files/viz_dashboard.service
      dest: /lib/systemd/system/viz_dashboard.service
      force: yes
      mode: 0664

  - name: reload systemd daemon
    ansible.builtin.systemd:
      daemon_reload: yes